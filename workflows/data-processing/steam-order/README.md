# Steam订单数据自动监控工作流

## 功能简介

本工作流实现了定时自动拉取Steam平台的订单数据，统计订单状态，并通过飞书机器人推送订单汇总和异常信息，帮助运营或财务团队及时掌握每日订单情况。

- 支持定时自动拉取Steam订单
- 自动统计订单状态（成功、退款、欺诈等）
- 支持无订单时自动提醒
- 支持飞书机器人推送订单汇总

## 主要节点说明

1. **定时触发**  
   每天18:30自动触发工作流。

2. **格式化时间**  
   获取当天日期，格式化为API请求所需格式。

3. **常量设置**  
   设置Steam应用ID、Key、飞书机器人地址等参数（请在此节点填写你的实际信息）。

4. **steam订单数据请求**  
   调用Steam官方API，拉取当天订单数据。

5. **If判断**  
   判断是否有订单数据，无订单时直接推送“无订单”提醒。

6. **解析出订单信息**  
   拆分订单列表，便于后续分组统计。

7. **更具订单状态对订单进行分组**  
   按订单状态（成功、退款、欺诈等）分组统计订单数量和金额。

8. **对分组数据进行计算**  
   生成飞书推送内容。

9. **订单数据通知/无订单提醒通知**  
   通过飞书机器人推送订单汇总或无订单提醒。

## 使用方法

### 1. 配置参数

在“常量设置”节点填写以下内容：

- `appId`：你的Steam应用ID
- `appKey`：你的Steam应用Key
- `feishuRobotUrl`：你的飞书机器人Webhook地址

### 2. 导入工作流

1. 在n8n中点击“Import from file”，选择本目录下的 `workflow.json` 文件导入。
2. 检查并配置“常量设置”节点参数。

### 3. 启动定时任务

- 默认每天18:30自动拉取当天订单数据并推送通知。
- 如需调整时间，可修改“定时触发”节点的时间设置。

### 4. 飞书机器人配置

- 请在飞书开放平台创建自定义机器人，获取Webhook地址，填入“常量设置”节点。

## 常见问题

- **API请求失败**：请检查appId/appKey是否正确，或Steam API是否可用。
- **飞书推送失败**：请检查Webhook地址是否正确，机器人是否有权限。
- **无订单数据**：如当天无订单，系统会自动推送“无订单”提醒。
- **时间不准确**：请检查n8n实例的时区设置，确保与业务需求一致。

## 贡献说明

如需扩展更多统计维度、支持多平台推送等，欢迎提交PR或在[Issues](https://github.com/Qinjianbo/n8n_workflow/issues)反馈建议！

---

如需进一步定制或有其他问题，欢迎随时联系维护者。